# https://github.com/travis-ci/docs-travis-ci-com/issues/910
language: minimal
dist: trusty
sudo: required

env:
  # Matrix for testing against multiple OSes as needed in the future
  matrix:
    - OS_TYPE=centos OS_VERSION=7

services:
  - docker

before_install:
  - sudo apt-get update
  - openssl aes-256-cbc -K $encrypted_5e9271a75a03_key -iv $encrypted_5e9271a75a03_iv -in keys/github_deploy_key.enc -out keys/github_deploy_key -d
  - rm keys/github_deploy_key.enc
  # - eval "$(ssh-agent -s)"
  # - chmod 600 deploy_rsa
  # - ssh-add deploy_rsa
  - sudo docker pull centos:centos${OS_VERSION}
  - sudo docker build --no-cache --rm --file=docker/Dockerfile.centos-${OS_VERSION} -t puppettest .
  - sudo docker run puppettest

  # - bash scripts/install.sh

script:
  # - bash scripts/build.sh

after_success:
  # - bash scripts/deploy.sh
